<?xml version="1.0" encoding="utf-8"?>
<project name ="PublishTestServer" default="start" basedir=".">
	

	<target name="start" depends="checksql_game,local_upload,server_op">
			
			 
	</target>

	<!-- 执行比较game表的批处理,将有变化的数据取出来 -->
	<target name="checksql_game">  
    		<exec dir="../PublishSQL/CompareGame" executable="cmd.exe">
						<arg line="/c 101_check_123.56.143.137.bat" />
        		<arg line="/c exit" />
    		</exec> 

				<move file="../PublishSQL/CompareGame/f_game_patch.sql" todir="./" />
	</target>
	
	<target name="local_upload">
			
		<scp todir="root:14dcD84rFeVjQtYA@123.56.143.137:/usr/local/undead/" port="22" trust="true">
		   <fileset file="./undeadServer.tar.gz"/>
		</scp>

		<scp todir="root:14dcD84rFeVjQtYA@123.56.143.137:/usr/local/undead/" port="22" trust="true">
		   <fileset file="./undeadSql.tar.gz"/>
		</scp>
		
		<scp todir="root:14dcD84rFeVjQtYA@123.56.143.137:/usr/local/undead/sql" port="22" trust="true">
		   <fileset file="./f_game_patch.sql"/>
		</scp>
		 
	</target>


	<target name="server_op" >  
			
      		<sshexec host="123.56.143.137" port="22" username="root"  password="14dcD84rFeVjQtYA"  
         		trust="true" command="cd /usr/local/undead;./stop_shell;./sql_shell"/>
		
	</target>

</project>

